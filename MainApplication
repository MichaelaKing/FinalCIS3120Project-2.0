# main.py
from config import SpotifyConfig
from SpotifyAuth import SpotifyAuth
from SpotifyDataFetcher import SpotifyDataFetcher
from MusicTasteAnalyzer import MusicTasteAnalyzer

class MainApplication:
    def __init__(self):
        self.auth = SpotifyAuth(SpotifyConfig.CLIENT_ID, SpotifyConfig.CLIENT_SECRET, SpotifyConfig.REDIRECT_URI)
        self.spotify_client = self.auth.get_spotify_client()
        self.data_fetcher = SpotifyDataFetcher(self.spotify_client)

    def run(self, user_favorite_genres):
        # Fetch top artists
        artist_data = self.data_fetcher.get_top_artists()
        
        # Analyze music taste
        analyzer = MusicTasteAnalyzer(artist_data)
        genre_counts = analyzer.analyze_genres()
        matching_genres = analyzer.compare_with_user_taste(user_favorite_genres)

        # Display results
        print("Top Genres:")
        for genre, count in genre_counts.most_common(10):
            print(genre, "-", count)

        print("\
Matching Genres with User's Taste:")
        print(matching_genres)

# Example usage
if __name__ == "__main__":
    # User's favorite genres
    user_favorite_genres = ['rock', 'pop', 'jazz']

    # Run the application
    app = MainApplication()
    app.run(user_favorite_genres)

print("Main application script created successfully")